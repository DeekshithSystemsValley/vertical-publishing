<?xml version="1.0" encoding="utf-8"?>
<odoo>
	<data>
        <record id="subscription_prepaid_form" model="ir.ui.view">
            <field name="name">subscription.prepaid.form</field>
            <field name="model">subscription.prepaid</field>
            <field name="arch" type="xml">
                <form string="Subscription Prepaid">
                    <header>
                        <button name="back2draft" string="Back to Draft" type="object" states="done" />
                        <button class="oe_highlight" name="get_prepaid_lines" string="Re-Generate Lines" type="object" states="draft,process"/>
                        <button class="oe_highlight" name="create_move" string="Create Journal Entry" type="object" states="process"/>
                        <field name="state" widget="statusbar" />
                    </header>
                    <sheet>
                        <group>
                            <group name="general-params">
                                <field name="start_date" required="1"/>
                                <field name="end_date" required="1"/>
                                <field name="total_prepaid_amount"/>
                                <field name="source_journal_ids" widget="many2many_tags"/>
                                <field name="company_id" groups="base.group_multi_company" widget="selection" />
                            </group>
                            <group name="accounting-params">
                                <field name="delivery_obligation_account_ids" required="1" widget="many2many_tags"/>
                                <field name="subscription_revenue_account_id" required="1"/>
                                <field name="subscription_journal_id" required="1"/>
                                <field name="move_id"/>
                            </group>
                        </group>
                        <group name="lines">
                            <field name="line_ids" nolabel="1"/>
                        </group>
                    </sheet>
                    <div class="oe_chatter">
                        <field name="message_follower_ids" widget="mail_followers"/>
                        <field name="message_ids" widget="mail_thread"/>
                    </div>
                </form>
            </field>
        </record>

        <!-- Tree view -->
        <record id="subscription_prepaid_tree" model="ir.ui.view">
            <field name="name">subscription.prepaid.tree</field>
            <field name="model">subscription.prepaid</field>
            <field name="arch" type="xml">
                <tree string="Subscription Prepaid" colors="blue:state=='draft'">
                    <field name="start_date" />
                    <field name="end_date" />
                    <field name="total_prepaid_amount"/>
                    <field name="company_currency_id" invisible="1"/>
                    <field name="state"/>
                </tree>
            </field>
        </record>

        <!-- Search view -->
        <record id="subscription_prepaid_filter" model="ir.ui.view">
            <field name="name">subscription.prepaid.filter</field>
            <field name="model">subscription.prepaid</field>
            <field name="arch" type="xml">
                <search string="Search Prepaid">
                    <filter name="draft" string="Draft" domain="[('state', '=', 'draft')]" />
                    <filter name="done" string="Done" domain="[('state', '=', 'done')]" />
                    <group string="Group By" name="groupby">
                        <filter name="state_groupby" string="State" context="{'group_by': 'state'}"/>
                    </group>
                </search>
            </field>
        </record>

        <record id="subscription_prepaid_revenue_action" model="ir.actions.act_window">
            <field name="name">Subscription Prepaid Revenue</field>
            <field name="res_model">subscription.prepaid</field>
            <field name="view_mode">tree,form</field>
            <field name="help" type="html">
                <p class="oe_view_nocontent_create">
                Click to start preparing a new prepaid revenue.
                </p><p>
                This view can be used by accountants in order to collect information about prepaid revenues based on start date and end date. It then allows to generate the corresponding prepaid journal entry in one click.
                </p>
            </field>
        </record>


        <!-- Form view for lines -->
    <record id="subscription_prepaid_line_form" model="ir.ui.view">
        <field name="name">subscription.prepaid.line.form</field>
        <field name="model">subscription.prepaid.line</field>
        <field name="arch" type="xml">
            <form string="Subscription Prepaid Lines">
                <group name="source" string="Source">
                    <field name="parent_id"/>
                    <field name="move_line_id"/>
                    <field name="move_date"/>
                    <field name="partner_id"/>
                    <field name="name"/>
                    <field name="start_date"/>
                    <field name="end_date"/>
                    <field name="account_id"/>
                    <field name="analytic_account_id" groups="analytic.group_analytic_accounting"/>
                    <field name="amount"/>
                    <field name="currency_id" invisible="1"/>
                </group>
                <group name="prepaid" string="Prepaid Computation">
                    <field name="prepaid_amount"/>
                    <field name="total_months"/>
                    <field name="prepaid_months"/>
                    <field name="company_currency_id" invisible="1"/>
                </group>
            </form>
        </field>
    </record>

    <!-- Tree view for lines -->
    <record id="subscription_prepaid_line_tree" model="ir.ui.view">
        <field name="name">subscription.prepaid.line.tree</field>
        <field name="model">subscription.prepaid.line</field>
        <field name="arch" type="xml">
            <tree string="Prepaid Lines">
                <field name="move_line_id"/>
                <field name="partner_id"/>
                <field name="name"/>
                <field name="start_date"/>
                <field name="end_date"/>
                <field name="total_months"/>
                <field name="prepaid_months"/>
                <field name="amount"/>
                <field name="prepaid_amount"/>
            </tree>
        </field>
    </record>

        <menuitem id="subscription_prepaid_revenue_menu" parent="menu_subscription_sales_main" action="subscription_prepaid_revenue_action" sequence="20"/>
    </data>
</odoo>